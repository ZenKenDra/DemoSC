<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DexPro - Live Realtime Exchange</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel untuk JSX Support -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { background-color: #0b0e14; color: white; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animasi Loading Awal */
        #root:empty::before {
            content: 'Memuat Market Data...';
            display: flex;
            height: 100vh;
            justify-content: center;
            align-items: center;
            color: #6b7280;
            font-family: sans-serif;
            font-size: 0.875rem;
        }
        
        /* Flash Animation untuk Harga */
        @keyframes flashGreen { 0% { color: #4ade80; } 100% { color: white; } }
        @keyframes flashRed { 0% { color: #f87171; } 100% { color: white; } }
        .flash-green { animation: flashGreen 1s ease-out; }
        .flash-red { animation: flashRed 1s ease-out; }

        /* Loading Spinner */
        .spinner {
            border: 3px solid rgba(255,255,255,0.1);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border-left-color: #3b82f6;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>

    <!-- IMPORT MAP -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "react-dom": "https://esm.sh/react-dom@18.2.0",
            "recharts": "https://esm.sh/recharts@2.12.7?external=react,react-dom"
        }
    }
    </script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } from 'recharts';

        // --- ICONS ---
        const IconActivity = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>;
        const IconMenu = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>;
        const IconSettings = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>;
        const IconArrowDownUp = () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 16 4 4 4-4"/><path d="M7 20V4"/><path d="m21 8-4-4-4 4"/><path d="M17 4v16"/></svg>;
        const IconChevronDown = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m6 9 6 6 6-6"/></svg>;
        const IconExternalLink = () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>;
        const IconRefresh = () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 21h5v-5"/></svg>;
        const IconWallet = () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12V7H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16v4"/><path d="M3 15v4a2 2 0 0 0 2 2h16v-4"/><path d="M14.5 18.5 21 12"/></svg>;

        // --- CONFIG ---
        const PAIR_ADDRESS = '0x2287a9620adcbf6250dc71be9ee9b2d3a1ec85a464fc6f5c06669e8d07b61bba';
        const API_URL = `https://api.dexscreener.com/latest/dex/pairs/ethereum/${PAIR_ADDRESS}`;

        function App() {
            // State
            const [walletConnected, setWalletConnected] = useState(false);
            const [walletAddress, setWalletAddress] = useState('');
            const [marketData, setMarketData] = useState({
                priceUsd: 0, priceChange: 0, volume24h: 0, marketCap: 0,
                pairName: 'ETH/USDC', loading: true
            });
            const [chartData, setChartData] = useState([]);
            const [currentTimeFrame, setCurrentTimeFrame] = useState('1H');
            const [inputToken, setInputToken] = useState('ETH');
            const [outputToken, setOutputToken] = useState('USDC');
            const [inputAmount, setInputAmount] = useState('');
            const [outputAmount, setOutputAmount] = useState('');
            const [isSwapping, setIsSwapping] = useState(false);
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [priceFlash, setPriceFlash] = useState(''); // 'green' or 'red'

            const prevPriceRef = useRef(0);
            const lastChartPointRef = useRef(null); // Untuk live chart update

            // --- 1. PERSISTENT WALLET CONNECTION ---
            useEffect(() => {
                const savedWallet = localStorage.getItem('dex_wallet_connected');
                if (savedWallet === 'true') {
                    setWalletConnected(true);
                    setWalletAddress('0x71C...9A21');
                }
            }, []);

            const toggleConnect = () => {
                if (walletConnected) {
                    setWalletConnected(false);
                    setWalletAddress('');
                    localStorage.removeItem('dex_wallet_connected');
                } else {
                    // Simulate instant connect
                    setWalletConnected(true);
                    setWalletAddress('0x71C...9A21');
                    localStorage.setItem('dex_wallet_connected', 'true');
                }
            };

            // --- 2. DATA FETCHING & REALTIME LOGIC ---
            const fetchMarketData = async () => {
                try {
                    const response = await fetch(API_URL);
                    const data = await response.json();
                    
                    if (data.pair) {
                        const pair = data.pair;
                        const currentPrice = parseFloat(pair.priceUsd);
                        
                        // Flash Effect Logic
                        if (prevPriceRef.current > 0) {
                            if (currentPrice > prevPriceRef.current) setPriceFlash('flash-green');
                            else if (currentPrice < prevPriceRef.current) setPriceFlash('flash-red');
                            setTimeout(() => setPriceFlash(''), 1000);
                        }
                        prevPriceRef.current = currentPrice;

                        setMarketData({
                            priceUsd: currentPrice,
                            priceChange: pair.priceChange.h24,
                            volume24h: pair.volume.h24,
                            marketCap: pair.fdv,
                            pairName: `${pair.baseToken.symbol}/${pair.quoteToken.symbol}`,
                            loading: false
                        });

                        // Jika chart kosong atau timeframe berubah, generate baru.
                        // Jika sudah ada, kita hanya "re-anchor" titik terakhir.
                        if (chartData.length === 0) {
                            generateChartData(currentPrice, currentTimeFrame);
                        } else {
                            // Update referensi terakhir untuk animasi smooth
                            lastChartPointRef.current = { time: 'LIVE', price: currentPrice };
                        }
                    }
                } catch (err) { 
                    console.error("API Error:", err); 
                }
            };

            // --- 3. TIMEFRAME & CHART GENERATION LOGIC ---
            const generateChartData = (price, tf) => {
                let points = 50;
                let volatility = 0.002; // default 0.2%
                let intervalMinutes = 1;

                // Atur parameter berdasarkan timeframe
                if (tf === '1H') {
                    points = 60; // 60 menit
                    volatility = 0.0005; // Volatilitas rendah (per menit)
                    intervalMinutes = 1;
                } else if (tf === '4H') {
                    points = 48; // 4 jam (per 5 menit)
                    volatility = 0.002;
                    intervalMinutes = 5;
                } else if (tf === '1D') {
                    points = 24; // 24 jam (per jam)
                    volatility = 0.01; // Volatilitas tinggi (per jam)
                    intervalMinutes = 60;
                }

                let data = [];
                let currentP = price;
                
                // Generate histori mundur
                for (let i = points; i > 0; i--) {
                    // Random walk algorithm
                    const change = (Math.random() - 0.5) * (price * volatility);
                    currentP = currentP - change;
                    
                    const time = new Date(Date.now() - i * intervalMinutes * 60000);
                    const timeStr = time.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    data.push({ 
                        originalTime: time, // Simpan objek date asli untuk sorting jika perlu
                        time: timeStr, 
                        price: currentP 
                    });
                }

                // Push titik live sekarang
                data.push({ time: 'LIVE', price: price });
                setChartData(data);
                lastChartPointRef.current = { time: 'LIVE', price: price };
            };

            // Initial Load & API Polling (Lebih cepat: 10 detik)
            useEffect(() => {
                fetchMarketData();
                const interval = setInterval(fetchMarketData, 10000); // Poll setiap 10 detik
                return () => clearInterval(interval);
            }, [currentTimeFrame]); // Re-fetch/Re-gen saat timeframe ganti

            // --- 4. MICRO-ANIMATION TICKER (Setiap 1 Detik) ---
            // Ini membuat chart terasa "Live" bergerak terus walaupun API dex screener belum update
            useEffect(() => {
                const tick = setInterval(() => {
                    if (lastChartPointRef.current && chartData.length > 0) {
                        setChartData(prevData => {
                            const newData = [...prevData];
                            const lastPoint = newData[newData.length - 1];
                            
                            // Gerakan mikro acak kecil (noise) di sekitar harga asli terakhir
                            // Agar grafik terlihat 'bernapas'
                            const noise = (Math.random() - 0.5) * (marketData.priceUsd * 0.0002); 
                            const simulatedPrice = marketData.priceUsd + noise;

                            newData[newData.length - 1] = {
                                ...lastPoint,
                                price: simulatedPrice
                            };
                            return newData;
                        });
                    }
                }, 1000); // Update grafik tiap 1 detik
                return () => clearInterval(tick);
            }, [marketData.priceUsd]); // Dependency ke harga asli

            // Swap Calculator Logic
            useEffect(() => {
                if (!inputAmount || !marketData.priceUsd) { setOutputAmount(''); return; }
                const val = parseFloat(inputAmount);
                if (isNaN(val)) return;
                const price = marketData.priceUsd;
                setOutputAmount(inputToken === 'ETH' ? (val * price).toFixed(2) : (val / price).toFixed(6));
            }, [inputAmount, inputToken, marketData.priceUsd]);

            // Handlers
            const handleTimeFrameChange = (tf) => {
                setCurrentTimeFrame(tf);
                setChartData([]); // Clear chart agar loading spinner muncul sebentar/regenerate
                setMarketData(prev => ({...prev, loading: true})); 
                // fetchMarketData akan dipanggil oleh useEffect karena dependency [currentTimeFrame]
            };

            const switchTokens = () => {
                setInputToken(outputToken);
                setOutputToken(inputToken);
                setInputAmount(outputAmount);
            };

            const formatNum = (n) => {
                if (!n) return '0';
                if (n >= 1e9) return (n/1e9).toFixed(2)+'B'; 
                if (n >= 1e6) return (n/1e6).toFixed(2)+'M';
                if (n >= 1e3) return (n/1e3).toFixed(2)+'K';
                return n.toFixed(2);
            };

            return (
                <div className="min-h-screen pb-6 flex flex-col font-sans">
                    
                    {/* NAVBAR */}
                    <nav className="border-b border-gray-800 bg-[#0b0e14]/95 backdrop-blur sticky top-0 z-50 px-4 h-16 flex items-center justify-between">
                        <div className="flex items-center gap-4">
                            <button className="md:hidden text-gray-400" onClick={()=>setIsMobileMenuOpen(!isMobileMenuOpen)}>
                                <IconMenu />
                            </button>
                            
                            <div className="flex items-center gap-2 text-blue-500">
                                <IconActivity />
                                <span className="text-xl font-bold tracking-tight text-white">DexPro</span>
                            </div>

                            <div className="hidden md:flex gap-1 bg-gray-900/50 p-1 rounded-lg border border-gray-800 ml-4">
                                {['Swap', 'Limit', 'DCA'].map(item => (
                                    <button key={item} className={`px-4 py-1.5 text-sm font-medium rounded-md transition-all ${item === 'Swap' ? 'bg-gray-800 text-white' : 'text-gray-400 hover:text-white'}`}>
                                        {item}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <button 
                            onClick={toggleConnect}
                            className={`flex items-center gap-2 px-3 sm:px-4 py-2 rounded-lg font-semibold text-xs sm:text-sm transition-all ${
                                walletConnected 
                                    ? 'bg-[#1a202e] text-green-400 border border-green-900/30'
                                    : 'bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/20'
                            }`}
                        >
                            {walletConnected && <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>}
                            {walletConnected ? walletAddress : 'Connect Wallet'}
                        </button>
                    </nav>

                    {/* MAIN CONTENT */}
                    <main className="flex-1 w-full max-w-[1600px] mx-auto p-3 sm:p-6 grid grid-cols-1 lg:grid-cols-12 gap-4 sm:gap-6">
                        
                        {/* LEFT COLUMN */}
                        <div className="lg:col-span-8 flex flex-col gap-4">
                            
                            {/* HEADER INFO */}
                            <div className="bg-[#131a2a] p-4 rounded-xl border border-gray-800/60 flex flex-col sm:flex-row justify-between sm:items-end gap-4 shadow-lg">
                                <div className="flex items-center gap-3 sm:gap-4">
                                    <div className="relative shrink-0">
                                        <div className="w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-slate-700 flex items-center justify-center border-2 border-[#131a2a] z-10 relative text-sm sm:text-lg">ðŸ”·</div>
                                        <div className="w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-blue-600 flex items-center justify-center border-2 border-[#131a2a] absolute top-0 left-5 text-sm sm:text-lg">ðŸ’µ</div>
                                    </div>
                                    <div className="pl-6 sm:pl-8">
                                        <h1 className="text-lg sm:text-xl font-bold flex items-center gap-2 text-gray-200">
                                            {marketData.pairName} 
                                            <a href={`https://dexscreener.com/ethereum/${PAIR_ADDRESS}`} target="_blank" className="text-gray-500 hover:text-blue-400"><IconExternalLink /></a>
                                        </h1>
                                        <div className="flex items-center gap-2 mt-1">
                                            {/* HARGA LIVE DENGAN ANIMASI FLASH */}
                                            <span className={`text-2xl sm:text-3xl font-mono font-bold tracking-tight transition-colors duration-300 ${priceFlash}`}>
                                                ${marketData.priceUsd.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 })}
                                            </span>
                                            {!marketData.loading && (
                                                <span className={`px-2 py-0.5 rounded text-xs sm:text-sm font-bold bg-opacity-20 ${marketData.priceChange >= 0 ? 'bg-green-500/10 text-green-400' : 'bg-red-500/10 text-red-400'}`}>
                                                    {marketData.priceChange >= 0 ? '+' : ''}{marketData.priceChange}%
                                                </span>
                                            )}
                                        </div>
                                    </div>
                                </div>
                                
                                {/* Stats */}
                                <div className="flex gap-6 text-xs sm:text-sm w-full sm:w-auto overflow-x-auto hide-scrollbar pb-1 sm:pb-0 border-t sm:border-t-0 border-gray-800 pt-3 sm:pt-0">
                                    <div className="flex flex-col whitespace-nowrap">
                                        <span className="text-gray-500 mb-1">Market Cap</span>
                                        <span className="font-semibold tracking-wide text-gray-200">{formatNum(marketData.marketCap)}</span>
                                    </div>
                                    <div className="flex flex-col whitespace-nowrap border-l border-gray-700 pl-6">
                                        <span className="text-gray-500 mb-1">Vol 24h</span>
                                        <span className="font-semibold tracking-wide text-gray-200">{formatNum(marketData.volume24h)}</span>
                                    </div>
                                </div>
                            </div>

                            {/* CHART CONTAINER */}
                            <div className="bg-[#131a2a] border border-gray-800 rounded-xl p-1 h-[350px] sm:h-[450px] lg:h-[550px] relative overflow-hidden flex flex-col justify-center items-center shadow-lg">
                                {chartData.length > 0 ? (
                                    <>
                                        <div className="absolute top-3 right-3 z-10 flex gap-1 bg-[#0b0e14]/80 backdrop-blur p-1 rounded-lg border border-gray-800">
                                            {['1H', '4H', '1D'].map((time) => (
                                                <button 
                                                    key={time} 
                                                    onClick={() => handleTimeFrameChange(time)} 
                                                    className={`px-3 py-1 text-[10px] sm:text-xs font-bold rounded transition-all duration-200 ${
                                                        currentTimeFrame === time 
                                                            ? 'bg-blue-600 text-white shadow-lg' 
                                                            : 'text-gray-400 hover:text-white hover:bg-gray-800'
                                                    }`}
                                                >
                                                    {time}
                                                </button>
                                            ))}
                                        </div>
                                        
                                        {/* Status Live */}
                                        <div className="absolute top-3 left-4 z-10 flex items-center gap-2">
                                            <span className="relative flex h-2.5 w-2.5">
                                              <span className="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                                              <span className="relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"></span>
                                            </span>
                                            <span className="text-[10px] font-bold text-green-500 tracking-wider">LIVE</span>
                                        </div>

                                        <div className="flex-1 w-full mt-4">
                                            <ResponsiveContainer width="100%" height="100%">
                                                <AreaChart data={chartData}>
                                                    <defs>
                                                        <linearGradient id="colorPrice" x1="0" y1="0" x2="0" y2="1">
                                                            <stop offset="5%" stopColor="#3b82f6" stopOpacity={0.3}/>
                                                            <stop offset="95%" stopColor="#3b82f6" stopOpacity={0}/>
                                                        </linearGradient>
                                                    </defs>
                                                    <CartesianGrid strokeDasharray="3 3" stroke="#1f2937" vertical={false} />
                                                    <XAxis 
                                                        dataKey="time" 
                                                        hide 
                                                    />
                                                    <YAxis 
                                                        domain={['auto', 'auto']} 
                                                        orientation="right" 
                                                        tick={{fill: '#9ca3af', fontSize: 11, fontWeight: 500}} 
                                                        axisLine={false} 
                                                        tickLine={false} 
                                                        width={60}
                                                        tickFormatter={(val) => `$${val.toFixed(0)}`}
                                                    />
                                                    <Tooltip 
                                                        contentStyle={{ backgroundColor: 'rgba(17, 24, 39, 0.9)', border: '1px solid #374151', borderRadius: '8px', fontSize: '12px' }} 
                                                        itemStyle={{ color: '#fff' }} 
                                                        labelStyle={{ color: '#9ca3af', marginBottom: '4px' }}
                                                        formatter={(val) => [`$${val.toFixed(2)}`, 'Price']} 
                                                    />
                                                    <Area 
                                                        type="monotone" 
                                                        dataKey="price" 
                                                        stroke="#3b82f6" 
                                                        strokeWidth={2} 
                                                        fill="url(#colorPrice)" 
                                                        isAnimationActive={false} // Disable default animation for smoother live updates
                                                    />
                                                </AreaChart>
                                            </ResponsiveContainer>
                                        </div>
                                    </>
                                ) : (
                                    <div className="flex flex-col items-center gap-3">
                                        <div className="spinner"></div>
                                        <span className="text-gray-400 text-sm font-medium animate-pulse">Memuat Data Pasar...</span>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* RIGHT COLUMN: SWAP */}
                        <div className="lg:col-span-4">
                            <div className="bg-[#131a2a] border border-gray-800 rounded-2xl p-5 shadow-2xl lg:sticky lg:top-24">
                                <div className="flex justify-between items-center mb-5">
                                    <span className="font-bold text-white text-lg">Swap</span>
                                    <div className="flex gap-3 text-gray-400">
                                        <button onClick={() => { setChartData([]); fetchMarketData(); }} className="hover:text-blue-400 transition-colors bg-gray-800/50 p-2 rounded-lg"><IconRefresh /></button>
                                        <button className="hover:text-blue-400 transition-colors bg-gray-800/50 p-2 rounded-lg"><IconSettings /></button>
                                    </div>
                                </div>

                                {/* INPUT */}
                                <div className="bg-[#0b0e14] rounded-xl p-4 border border-gray-800 hover:border-gray-600 transition-all duration-300 focus-within:border-blue-500/50 focus-within:ring-1 focus-within:ring-blue-500/20">
                                    <div className="flex justify-between text-xs font-medium text-gray-400 mb-2">
                                        <span>Jual</span>
                                        <span className="text-blue-400 cursor-pointer hover:text-blue-300">Max: {walletConnected ? '1.45' : '0'}</span>
                                    </div>
                                    <div className="flex justify-between items-center gap-3">
                                        <input 
                                            type="number" placeholder="0" value={inputAmount} onChange={(e) => setInputAmount(e.target.value)}
                                            className="bg-transparent text-3xl font-bold text-white outline-none w-full placeholder-gray-700"
                                        />
                                        <div className="flex items-center gap-2 bg-[#1f2937] px-3 py-1.5 rounded-full shrink-0 border border-gray-700 hover:bg-gray-700 cursor-pointer transition-colors">
                                            <span className="font-bold text-sm sm:text-base">{inputToken}</span>
                                            <IconChevronDown />
                                        </div>
                                    </div>
                                    <div className="text-xs font-medium text-gray-500 mt-2">
                                        {marketData.loading ? '...' : `$${inputAmount ? (inputAmount * (inputToken === 'ETH' ? marketData.priceUsd : 1)).toFixed(2) : '0.00'}`}
                                    </div>
                                </div>

                                {/* ARROW */}
                                <div className="relative h-4 z-10 my-[-10px]">
                                    <button onClick={switchTokens} className="absolute left-1/2 -translate-x-1/2 -translate-y-1/2 bg-[#131a2a] border-4 border-[#131a2a] p-2 rounded-xl text-gray-400 hover:text-blue-400 hover:bg-gray-800 transition-all shadow-lg hover:scale-110 active:scale-95">
                                        <IconArrowDownUp />
                                    </button>
                                </div>

                                {/* OUTPUT */}
                                <div className="bg-[#0b0e14] rounded-xl p-4 border border-gray-800 hover:border-gray-600 transition-colors mt-2 mb-6">
                                    <div className="flex justify-between text-xs font-medium text-gray-400 mb-2">
                                        <span>Terima</span>
                                        <span>Bal: {walletConnected ? '500.00' : '0'}</span>
                                    </div>
                                    <div className="flex justify-between items-center gap-3">
                                        <input 
                                            type="text" placeholder="0" value={outputAmount} readOnly
                                            className="bg-transparent text-3xl font-bold text-white outline-none w-full placeholder-gray-700 cursor-default"
                                        />
                                        <div className="flex items-center gap-2 bg-[#1f2937] px-3 py-1.5 rounded-full shrink-0 border border-gray-700 hover:bg-gray-700 cursor-pointer transition-colors">
                                            <span className="font-bold text-sm sm:text-base">{outputToken}</span>
                                            <IconChevronDown />
                                        </div>
                                    </div>
                                    <div className="text-xs font-medium text-gray-500 mt-2 flex justify-between">
                                        <span>â‰ˆ ${outputAmount ? (outputAmount * (outputToken === 'USDC' ? 1 : marketData.priceUsd)).toFixed(2) : '0.00'}</span>
                                        <span className="text-green-500/80">Best route</span>
                                    </div>
                                </div>

                                {/* BUTTON */}
                                <button 
                                    onClick={() => !walletConnected ? toggleConnect() : handleSwap()}
                                    disabled={isSwapping || (walletConnected && !inputAmount)}
                                    className={`w-full py-4 rounded-xl font-bold text-lg transition-all shadow-xl active:scale-[0.98] ${
                                        !walletConnected 
                                            ? 'bg-blue-600 hover:bg-blue-500 text-white shadow-blue-900/30' 
                                            : !inputAmount 
                                                ? 'bg-[#1f2937] text-gray-500 cursor-not-allowed' 
                                                : 'bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white shadow-lg'
                                    }`}
                                >
                                    {isSwapping 
                                        ? <span className="flex items-center justify-center gap-2"><div className="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"/> Menukar...</span>
                                        : !walletConnected 
                                            ? 'Hubungkan Dompet' 
                                            : !inputAmount 
                                                ? 'Masukkan Jumlah' 
                                                : 'Tukar Sekarang'}
                                </button>
                            </div>
                        </div>

                    </main>
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
